(function(_){for(var r in _){_[r].__farm_resource_pot__='home_index_cfe6.js';(globalThis || window || global)['6a871738bed45b567e434cb8d22e0796'].__farm_module_system__.register(r,_[r])}})({"16f15d87":function e(e,d,r,c){e._m(d),e.o(d,"default",()=>l);var n=r("036dd75c"),a=r("ebc3afb6"),f=e.i(r("d1c0d8ea")),i=e.i(r("f4be93cd"));function l(d){var r=d.handleClose,c=a.useSelector(e=>e.user).type;return n.jsx("div",{children:"driver"===c?n.jsx(e.f(f),{}):n.jsx(e.f(i),{handleClose:r})});}},"288cfb9a":function e(e,a,s,t){e._m(a),e.o(a,"default",()=>x);var l=s("95dab18f"),r=s("c919fece");s("1e2e6a6a"),s("02ab23c1");var c=s("036dd75c"),i=s("43e033a1"),n=s("ebc3afb6"),d=s("5ef950a6"),o=s("65738078"),f=s("b9886691"),m=e.i(s("3b359b6b"));function x(a){var s=a.travelId,t=a.name,l=a.direction,r=a.fee,x=a.travelDate,y=a.travelType,v=a.seats,N=a.freeSeats,g=a.preview,S=n.useSelector(e=>e.theme).theme,w=n.useQueryStore("travels").setQueryStore,I="offer"===y;return c.jsx("article",{className:"card card-compact shadow-xl bg-gradient-to-b from-transparent flex-grow ".concat(g?"blur-xs animate-pulse":" ".concat("light"===S?"to-base-200":"to-base-300")),onClick:p(s,w),children:c.jsxs("div",{className:"card-body justify-around",children:[c.jsx("header",{className:"flex flex-col",children:c.jsxs("div",{className:"flex justify-between h-4",children:[c.jsx("time",{className:"text-accent font-bold",dateTime:e.f(m)(x).format(),children:e.f(m)(x).isSame(e.f(m)(),"day")?"Hoy":e.f(m)(x).isSame(e.f(m)().add(1,"day"),"day")?"MaÃ±ana":e.f(m)(x).format("DD/MM/YYYY")}),c.jsx("span",{className:"font-bold text-base",children:r&&f.formatCurrency(r)})]})}),c.jsxs("main",{className:"flex flex-col",children:[c.jsxs("section",{className:"flex items-center gap-2",children:[c.jsx("h2",{className:"card-title font-bold text-2xl",children:o.capitalize(t.split(" ")[0])}),c.jsx("span",{"aria-label":I?"offer":"request",children:I?"ðŸš˜":"ðŸ¤š"})]}),c.jsx("section",{children:c.jsx("span",{className:"badge ".concat(l?"badge-primary":"badge-secondary"),children:l?"Ida":"Vuelta"})}),c.jsx("section",{children:c.jsx(i.SeatsStatus,{maxSeats:v,reservedSeats:I?v-N:v})})]}),c.jsxs("footer",{className:"flex flex-col text-base-content text-opacity-70 items-end",children:[c.jsx("span",{className:"",children:I?l?b:h:l?u:j}),c.jsxs("time",{className:"flex justify-end gap-1 font-bold",children:[c.jsx(d.IconClock,{size:16,strokeWidth:3}),e.f(m)(x).format("hh:mm a")]})]})]})});}var h="Sale",b="Llega",j="Quiere salir",u="Quiere llegar",p=(e,a)=>()=>{a(a=>a.map(a=>r._(l._({},a),{selected:a.travelId===e})));};},"3c51f336":function e(e,a,t,s){e._m(a),e.o(a,"default",()=>i);var l=t("95dab18f"),r=t("036dd75c"),n=t("ebc3afb6"),c=e.i(t("288cfb9a"));function i(e){var a=e.travels,t=void 0===a?[]:a,s=n.useSelector(e=>e.user).type,l=t.filter(e=>"offer"===e.travelType),c=t.filter(e=>"request"===e.travelType);return"driver"===s&&0===c.length||"passenger"===s&&0===t.length?r.jsx("article",{className:"w-full h-full grid place-items-center",children:r.jsxs("main",{children:[r.jsx("h2",{className:"text-center font-bold text-3xl",children:"No se encontraron viajes"}),r.jsxs("p",{className:"text-center text-balance",children:["No hay propuestas de viaje por tu zona","passenger"===s&&", crea una y aparecerÃ¡ aquÃ­"]})]})}):r.jsxs("div",{children:["passenger"===s&&l.length>0&&r.jsx(d,{title:"Ofertas de viaje",travels:l}),c.length>0&&r.jsx(d,{title:"Solicitudes de viaje",travels:c})]});}var d=a=>{var t=a.title,s=a.travels;return r.jsxs("section",{className:"mb-4",children:[r.jsxs("header",{className:"flex justify-between px-1",children:[r.jsx("h3",{className:"text-lg font-bold",children:t}),r.jsxs("p",{className:"text-base-content  text-opacity-80",children:[s.length," ",1===s.length?"viaje":"viajes"]})]}),r.jsx("div",{className:"flex px-2 gap-2 w-dvw overflow-x-scroll snap-x snap-mandatory",children:o(s).map((a,t)=>r.jsx("div",{className:"flex ".concat(s.length>2?"flex-col min-w-[calc(50vw-0.5rem)]":"min-w-[calc(100vw-0.5rem)]"," gap-2 snap-start "),children:a.map(a=>r.jsx(e.f(c),l._({},a),a.travelId))},t))})]});},o=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,t=[],s=[];return e.forEach((l,r)=>{s.push(l),(s.length===a||r===e.length-1)&&(t.push(s),s=[]);}),t;};},"5aa81eeb":function e(e,s,a,r){e._m(s),e.o(s,"default",()=>h);var t=a("957d803e"),i=a("036dd75c"),n=e.i(a("a7af5c17")),c=a("da0b8b76"),l=e.i(a("38869417")),o=a("dcd4b961"),u=a("ebc3afb6"),d=e.i(a("6982241b")),f=e.i(a("728ce5c3")),m=e.i(a("9d9a54d4")),x=e.i(a("891cbd05")),v=e.i(a("fae7f52f")),p=e.i(a("61128824")),b=a("fea3b793"),g=a("8e714956");function h(s){var a=s.handleClose,r=g.useForm({}),h=u.useSelector(e=>e.user),j=h.user,y=h.type,T=u.useSelector(e=>e.notification).turnOnNotification,S=t._(c.useState(!0),2),N=S[0],w=S[1],D=u.useQueryStore(e.f(v).TRAVELS),E=D.data,Q=D.setQueryStore,A=o.useQueryClient(),C=o.useMutation({mutationFn:s=>"driver"===y?e.f(d).newOffer(s):e.f(p).newRequest(s),onMutate:async s=>{await A.invalidateQueries({queryKey:[e.f(v).TRAVELS]});var r=b.optimisticUpdate(E,Q)(s);return a(),r;},onSuccess:()=>{w(!0),e.f(l).success("Viaje publicado"),T("newTravel");},onError:(s,a,r)=>{(null==r?void 0:r.previousTravels)&&Q(()=>r.previousTravels),e.f(l).error(s.message);},onSettled:async()=>{await A.invalidateQueries({queryKey:[e.f(v).TRAVELS]});}}),F=C.mutate,O=C.isPending;return i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold mb-2",children:"Nuevo viaje ðŸš€ "}),i.jsxs("form",{className:"grid grid-cols-4 gap-2 items-stretch",onSubmit:e=>{e.preventDefault();var s=new FormData(e.currentTarget);F("driver"===y?b.getDriverTravelData(s,j):b.getPassengerTravelData(s,j));},children:[N?i.jsx(e.f(f),{}):"driver"===y?i.jsx(e.f(m),{}):i.jsx(e.f(x),{formController:r}),i.jsxs("section",{className:e.f(n).formActions,children:[i.jsxs("label",{htmlFor:"simple",className:"flex flex-col w-17",children:[i.jsx("span",{className:"".concat(e.f(n).expressText," ").concat(N?e.f(n).expressTextOn:e.f(n).expressTextOff),children:"Express âš¡"}),i.jsx("input",{id:"simple",className:"toggle toggle-accent",type:"checkbox",onChange:()=>{w(e=>!e);},checked:N})]}),i.jsx("button",{type:"submit",className:"btn btn-primary w-24",disabled:O,children:O?i.jsx("span",{className:"loading loading-spinner"}):"Publicar"})]})]})]});}},"6ee992c5":function e(e,a,d,f){e._m(a),e.o(a,"default",()=>i);var l=d("036dd75c"),n=d("ebc3afb6"),r=e.i(d("9fbf1283")),s=e.i(d("ba7462fa"));function i(a){var d=a.handleClose,f=n.useSelector(e=>e.user).type;return l.jsx("div",{children:"driver"===f?l.jsx(e.f(r),{handleClose:d}):l.jsx(e.f(s),{handleClose:d})});}},"728ce5c3":function e(e,a,l,r){e._m(a),e.o(a,"default",()=>n);var i=l("036dd75c"),t=e.i(l("3b359b6b")),s=l("fea3b793"),c=l("e0262023");function n(){var a=e.f(t)().hour()>=22,l=e.f(t)().format("YYYY-MM-DD"),r=e.f(t)().add(1,"day").format("YYYY-MM-DD");return i.jsxs(i.Fragment,{children:[i.jsx("label",{htmlFor:"",className:"col-span-2",children:i.jsxs("select",{name:"travelDay",id:"travelDay",className:"select select-bordered w-full max-w-xs",defaultValue:a?r:l,required:!0,children:[i.jsx("option",{value:l,children:"Hoy"}),i.jsx("option",{value:r,children:"MaÃ±ana"})]})}),i.jsx("label",{htmlFor:"timeTravel",className:"col-span-2 flex flex-col",children:i.jsx("input",{type:"time",name:"travelTime",id:"travelTime",className:"input input-bordered",step:600,defaultValue:s.getNextIntervalTime(),required:!0})}),i.jsx("div",{className:"form-control",children:i.jsxs("label",{className:"label cursor-pointer",children:[i.jsx("span",{className:"label-text",children:"Ida"}),i.jsx("input",{type:"radio",name:"direction",className:"radio radio-primary",value:c.TravelDirection.INBOUND,defaultChecked:a||s.getDefaultDirectionValue()===c.TravelDirection.INBOUND,required:!0})]})}),i.jsx("div",{className:"form-control",children:i.jsxs("label",{className:"label cursor-pointer",children:[i.jsx("span",{className:"label-text",children:"Vuelta"}),i.jsx("input",{type:"radio",name:"direction",className:"radio radio-primary",value:c.TravelDirection.OUTBOUND,defaultChecked:!a&&s.getDefaultDirectionValue()===c.TravelDirection.OUTBOUND,required:!0})]})})]});}},"7d7a6b45":function e(e,l,a,t){e._m(l),e.o(l,"default",()=>b);var r=a("95dab18f"),s=a("c919fece"),i=a("957d803e"),f=a("036dd75c"),d=a("43e033a1"),o=a("da0b8b76"),n=e.i(a("3c51f336")),u=a("ebc3afb6"),c=a("dcd4b961"),v=e.i(a("c184653d")),h=e.i(a("16f15d87")),D=e.i(a("fae7f52f")),j=e.i(a("6ee992c5")),x=e.i(a("5aa81eeb"));function b(){var l=i._(o.useState(!1),2),a=l[0],t=l[1],b=i._(o.useState(!1),2),q=b[0],y=b[1],S=i._(o.useState(!1),2),T=S[0],C=S[1],w=u.useSelector(e=>e.theme).switchBlur,_=c.useQuery({queryKey:[e.f(D).TRAVELS],queryFn:e.f(v).getTravelList}),E=_.data,L=_.isLoading,m=_.isError,g=u.useQueryStore(e.f(D).TRAVELS),p=g.data,A=g.setQueryStore,M=e=>()=>{w(),"offerDetail"===e&&y(!0),"new"===e&&t(!0),"requestDetail"===e&&C(!0);},Q=e=>()=>{w(),("offerDetail"===e||"requestDetail"===e)&&("offerDetail"===e&&y(!1),"requestDetail"===e&&C(!1),A(e=>e.map(e=>s._(r._({},e),{selected:!1})))),"new"===e&&t(!1);};return(o.useEffect(()=>{var e=null==p?void 0:p.find(e=>e.selected);e&&("offer"===e.travelType&&M("offerDetail")(),"request"===e.travelType&&M("requestDetail")());},[p]),L)?f.jsx(d.Loading,{}):m?f.jsx(d.Error,{}):f.jsxs("div",{className:"h-full",children:[f.jsx(e.f(n),{travels:E}),f.jsx(d.AddButton,{onClick:M("new")}),f.jsx(d.TravelModal,{visible:a,handleClose:Q("new"),children:f.jsx(e.f(x),{handleClose:Q("new")})}),f.jsx(d.TravelModal,{visible:q,handleClose:Q("offerDetail"),children:q&&f.jsx(e.f(h),{handleClose:Q("offerDetail")})}),f.jsx(d.TravelModal,{visible:T,handleClose:Q("requestDetail"),children:T&&f.jsx(e.f(j),{handleClose:Q("requestDetail")})})]});}},"891cbd05":function e(e,a,l,s){e._m(a),e.o(a,"default",()=>u);var r=l("95dab18f"),t=l("c919fece");l("4ba47fd0");var i=l("036dd75c"),n=l("e0262023"),c=l("fea3b793"),o=l("ebc3afb6"),d=e.i(l("3b359b6b"));function u(a){var l,s=a.formController,u=s.register,m=s.watch,x=o.useSelector(e=>e.user).user,p=!!parseInt(null!==(l=m("direction"))&&void 0!==l?l:c.getDefaultDirectionValue());return i.jsxs(i.Fragment,{children:[i.jsxs("label",{className:"col-span-3 flex flex-col",children:[i.jsxs("span",{className:"label-text",children:["Punto de ",p?"recojo":"destino"]}),i.jsx("textarea",t._(r._({className:"textarea textarea-bordered"},u("customPoint")),{name:"customPoint",id:"customPoint",defaultValue:null==x?void 0:x.pickUpPoint}))]}),i.jsxs("label",{className:"col-span-1 flex flex-col h-full",children:[i.jsx("span",{className:"label-text",children:"Pasajeros"}),i.jsx("input",t._(r._({className:"input input-bordered",type:"number"},u("numPassengers")),{name:"numPassengers",id:"numPassengers",min:1,defaultValue:1,max:10}))]}),i.jsxs("label",{htmlFor:"travelDay",className:"col-span-2 flex flex-col",children:[i.jsx("span",{className:"label-text",children:"DÃ­a"}),i.jsx("input",t._(r._({className:"input input-bordered w-full",type:"date",min:e.f(d)().format("YYYY-MM-DD")},u("travelDay")),{name:"travelDay",id:"travelDay",defaultValue:e.f(d)().format("YYYY-MM-DD"),required:!0}))]}),i.jsxs("label",{htmlFor:"timeTravel",className:"col-span-2 flex flex-col",children:[i.jsx("span",{className:"label-text",children:"Hora"}),i.jsx("input",t._(r._({type:"time"},u("travelTime")),{name:"travelTime",id:"travelTime",className:"input input-bordered",step:600,defaultValue:c.getNextIntervalTime(),required:!0}))]}),i.jsxs("label",{className:"label cursor-pointer",children:[i.jsx("span",{className:"label-text",children:"Ida"}),i.jsx("input",t._(r._({type:"radio"},u("direction")),{name:"direction",className:"radio radio-primary",value:n.TravelDirection.INBOUND,defaultChecked:c.getDefaultDirectionValue()===n.TravelDirection.INBOUND,required:!0}))]}),i.jsxs("label",{className:"label cursor-pointer",children:[i.jsx("span",{className:"label-text",children:"Vuelta"}),i.jsx("input",t._(r._({type:"radio"},u("direction")),{name:"direction",className:"radio radio-primary",value:n.TravelDirection.OUTBOUND,defaultChecked:c.getDefaultDirectionValue()===n.TravelDirection.OUTBOUND,required:!0}))]}),i.jsxs("label",{className:"col-span-2 flex items-center justify-around",children:[i.jsx("span",{className:"label-text",children:"Para mÃ­"}),i.jsx("input",t._(r._({className:"checkbox checkbox-primary",defaultChecked:!0,type:"checkbox"},u("forMe")),{name:"forMe",id:"forMe"}))]})]});}},"9d9a54d4":function e(e,a,l,r){e._m(a),e.o(a,"default",()=>c),l("1135e585");var i=l("036dd75c"),s=e.i(l("3b359b6b")),t=l("fea3b793"),n=l("ebc3afb6"),d=l("e0262023");function c(){var a=n.useSelector(e=>e.user).user;return i.jsxs(i.Fragment,{children:[i.jsxs("label",{className:"col-span-2 flex flex-col",children:["Asientos reservados",i.jsx("input",{type:"number",name:"bookedSeats",id:"bookedSeats",className:"input input-bordered",min:0,max:(null==a?void 0:a.seats)-1,defaultValue:0,required:!0})]}),i.jsxs("label",{htmlFor:"fee",className:"col-span-2 flex flex-col",children:["Tarifa S/.",i.jsx("input",{className:"input input-bordered w-full",type:"number",min:0,step:.5,name:"fee",id:"fee",defaultValue:null==a?void 0:a.fee.toFixed(2),required:!0})]}),i.jsxs("label",{htmlFor:"travelDay",className:"col-span-2 flex flex-col",children:["Fecha",i.jsx("input",{className:"input input-bordered w-full",type:"date",min:e.f(s)().format("YYYY-MM-DD"),name:"travelDay",id:"travelDay",defaultValue:e.f(s)().format("YYYY-MM-DD"),required:!0})]}),i.jsxs("label",{htmlFor:"timeTravel",className:"col-span-2 flex flex-col",children:["Hora",i.jsx("input",{type:"time",name:"travelTime",id:"travelTime",className:"input input-bordered",step:600,defaultValue:t.getNextIntervalTime(),required:!0})]}),i.jsx("div",{className:"form-control",children:i.jsxs("label",{className:"label cursor-pointer",children:[i.jsx("span",{className:"label-text",children:"Ida"}),i.jsx("input",{type:"radio",name:"direction",className:"radio radio-primary",value:d.TravelDirection.INBOUND,defaultChecked:t.getDefaultDirectionValue()===d.TravelDirection.INBOUND,required:!0})]})}),i.jsx("div",{className:"form-control",children:i.jsxs("label",{className:"label cursor-pointer",children:[i.jsx("span",{className:"label-text",children:"Vuelta"}),i.jsx("input",{type:"radio",name:"direction",className:"radio radio-primary",value:d.TravelDirection.OUTBOUND,defaultChecked:t.getDefaultDirectionValue()===d.TravelDirection.OUTBOUND,required:!0})]})})]});}},"9fbf1283":function e(e,a,l,s){e._m(a),e.o(a,"default",()=>y);var t=l("957d803e");l("1e2e6a6a"),l("02ab23c1");var n=l("036dd75c"),i=e.i(l("38869417")),r=e.i(l("3b359b6b")),c=l("dcd4b961"),d=l("43e033a1"),o=e.i(l("fae7f52f")),u=l("ebc3afb6"),x=e.i(l("6982241b")),v=e.i(l("61128824")),f=e.i(l("c184653d")),m=l("65738078"),b=l("b9886691");function y(a){var l=a.handleClose,s=u.useSelector(e=>e.user).user,y=u.useQueryStore(e.f(o).TRAVELS).data,p=null==y?void 0:y.find(e=>e.selected),h=null==p?void 0:p.travelId,j=null==p?void 0:p.userCode,N=t._(c.useQueries({queries:[{queryKey:[e.f(o).PASSENGER_DETAIL,j],queryFn:()=>e.f(v).getPassengerByCode(j),enabled:!!p},{queryKey:[e.f(o).TRAVEL_PASSENGERS,h],queryFn:()=>e.f(f).getTravelPassengers(h),enabled:!!h}]}),2),S=N[0].data,g=N[1].data,E=c.useQueryClient(),Q=u.useQueryStore(e.f(o).TRAVELS),T=Q.data,q=Q.setQueryStore,A=c.useMutation({mutationFn:a=>e.f(x).takeTravelRequest({customFee:s.fee,travelId:a}),onMutate:()=>(q(e=>null==e?void 0:e.filter(e=>e.travelId!==h)),{previus:T}),onSuccess:()=>{E.invalidateQueries({queryKey:[e.f(o).TRAVELS]}),l(),e.f(i).success("Viaje tomado");},onError:(a,l,s)=>{var t=a.message;q(()=>null==s?void 0:s.previus),e.f(i).error(t);}}).mutate,R=null==p?void 0:p.seats,C=null==g?void 0:g.filter(e=>e.name!=(null==S?void 0:S.name)),V=R-(null==g?void 0:g.length);return n.jsxs("article",{children:[n.jsxs("header",{className:"flex flex-col py-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("h2",{className:"font-bold text-3xl",children:m.capitalize(null==p?void 0:p.name.split(" ")[0])+" ðŸ¤š"}),n.jsxs("span",{className:"text-2xl font-bold",children:[b.formatCurrency(null==p?void 0:p.fee)," "]})]}),n.jsx("span",{className:"badge ".concat((null==p?void 0:p.direction)?"badge-primary":"badge-secondary"),children:(null==p?void 0:p.direction)?"Ida":"Vuelta"})]}),n.jsxs("main",{children:[n.jsxs("section",{children:[n.jsx("p",{className:"text-xl text-accent font-bold text-pretty",children:"".concat((null==p?void 0:p.direction)?"Quiere llegar a la universidad ":"Quiere salir de la universidad ").concat(e.f(r)(null==p?void 0:p.travelDate).calendar())}),n.jsx(d.SeatsStatus,{maxSeats:R,reservedSeats:R})]}),n.jsx("section",{className:"py-1",children:n.jsx("p",{className:"text-lg text-balance",children:null==p?void 0:p.customPoint})}),n.jsxs("section",{children:[R-1>0&&n.jsxs("p",{className:"text-base-content text-opacity-70",children:["Nos acompaÃ±a".concat(R-1>1?"n":"")," "]}),n.jsx("ul",{className:"flex gap-2",children:null==C?void 0:C.map((e,a)=>n.jsx("li",{className:"font-bold",children:m.capitalize(e.name.split(" ")[0])},a))}),V>0&&n.jsx("p",{className:"text-base-content text-opacity-70",children:"".concat((null==C?void 0:C.length)>0?"y":""," ").concat(V," persona").concat(V>1?"s":""," mÃ¡s")})]}),n.jsx("section",{className:"flex justify-end",children:n.jsx("button",{className:"btn btn-primary animate-pulse",onClick:()=>{A(null==p?void 0:p.travelId);},children:"Tomar viaje"})})]})]});}},"a7af5c17":function e(e,f,s,x){e._m(f),f.default={expressText:"expressText-9cdcf0fd",expressTextOff:"expressTextOff-9cdcf0fd",expressTextOn:"expressTextOn-9cdcf0fd",formActions:"formActions-9cdcf0fd"};},"b9886691":function c(c,o,n,r){c._m(o),c.o(o,"formatCurrency",()=>t),n("1135e585");var t=c=>c?"".concat("S/."," ").concat(Number(c).toFixed(2)):"";},"ba7462fa":function e(e,a,l,s){e._m(a),e.o(a,"default",()=>y);var t=l("95dab18f"),n=l("c919fece"),i=l("957d803e");l("1e2e6a6a"),l("02ab23c1");var c=l("036dd75c"),d=e.i(l("38869417")),r=e.i(l("3b359b6b")),o=l("dcd4b961"),u=l("43e033a1"),x=e.i(l("fae7f52f")),v=l("ebc3afb6"),f=e.i(l("61128824")),m=e.i(l("c184653d")),b=l("65738078"),p=l("b9886691");function y(a){var l=a.handleClose,s=v.useQueryStore(e.f(x).TRAVELS).data,y=null==s?void 0:s.find(e=>e.selected),h=null==y?void 0:y.travelId,j=null==y?void 0:y.userCode,N=i._(o.useQueries({queries:[{queryKey:[e.f(x).PASSENGER_DETAIL,j],queryFn:()=>e.f(f).getPassengerByCode(j),enabled:!!y},{queryKey:[e.f(x).TRAVEL_PASSENGERS,h],queryFn:()=>e.f(m).getTravelPassengers(h),enabled:!!h}]}),2),S=N[0].data,g=N[1].data,E=o.useQueryClient(),Q=v.useQueryStore(e.f(x).TRAVELS),q=Q.data,A=Q.setQueryStore,R=o.useMutation({mutationFn:a=>e.f(f).joinRequest(a),onMutate:()=>(A(e=>null==e?void 0:e.map(e=>e.travelId===h?n._(t._({},e),{seats:e.seats+1}):e)),l(),{previus:q}),onSuccess:()=>{E.invalidateQueries({queryKey:[e.f(x).TRAVELS,h]}),e.f(d).success("Te uniste a la solicitud de viaje");},onError:(a,l,s)=>{var t=a.message;A(()=>null==s?void 0:s.previus),e.f(d).error(t);}}).mutate,T=null==y?void 0:y.seats,C=null==g?void 0:g.filter(e=>e.name!=(null==S?void 0:S.name)),_=T-(null==g?void 0:g.length);return c.jsxs("article",{children:[c.jsxs("header",{className:"flex flex-col py-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("h2",{className:"font-bold text-3xl",children:b.capitalize(null==y?void 0:y.name.split(" ")[0])+" ðŸ¤š"}),c.jsxs("span",{className:"text-2xl font-bold",children:[p.formatCurrency(null==y?void 0:y.fee)," "]})]}),c.jsx("span",{className:"badge ".concat((null==y?void 0:y.direction)?"badge-primary":"badge-secondary"),children:(null==y?void 0:y.direction)?"Ida":"Vuelta"})]}),c.jsxs("main",{children:[c.jsxs("section",{children:[c.jsx("p",{className:"text-xl text-accent font-bold text-pretty",children:"".concat((null==y?void 0:y.direction)?"Quiere llegar a la universidad ":"Quiere salir de la universidad ").concat(e.f(r)(null==y?void 0:y.travelDate).calendar())}),c.jsx(u.SeatsStatus,{maxSeats:T,reservedSeats:T})]}),c.jsx("section",{className:"py-1",children:c.jsx("p",{className:"text-lg text-balance",children:null==y?void 0:y.customPoint})}),c.jsxs("section",{children:[T-1>0&&c.jsxs("p",{className:"text-base-content text-opacity-70",children:["Nos acompaÃ±a".concat(T-1>1?"n":"")," "]}),c.jsx("ul",{className:"flex gap-2",children:null==C?void 0:C.map((e,a)=>c.jsx("li",{className:"font-bold",children:b.capitalize(e.name.split(" ")[0])},a))}),_>0&&c.jsx("p",{className:"text-base-content text-opacity-70",children:"".concat((null==C?void 0:C.length)>0?"y":""," ").concat(_," persona").concat(_>1?"s":""," mÃ¡s")})]}),c.jsx("section",{className:"flex justify-end",children:c.jsx("button",{className:"btn btn-primary animate-pulse",onClick:()=>{R(null==y?void 0:y.travelId);},children:"Unirme"})})]})]});}},"d1c0d8ea":function i(i,n,r,d){i._m(n),i.o(n,"default",()=>c);var e=r("036dd75c");function c(){return e.jsx("div",{children:"DriverView"});}},"f4be93cd":function e(e,a,s,l){e._m(a),e.o(a,"default",()=>h);var t=s("95dab18f"),n=s("c919fece"),i=s("957d803e");s("1e2e6a6a"),s("02ab23c1");var c=s("036dd75c"),d=e.i(s("38869417")),r=s("dcd4b961"),o=e.i(s("3b359b6b")),u=s("43e033a1"),f=e.i(s("fae7f52f")),v=s("ebc3afb6"),x=e.i(s("6982241b")),m=e.i(s("61128824")),p=e.i(s("c184653d")),b=s("65738078"),y=s("b9886691");function h(a){var s=a.handleClose,l=v.useQueryStore(e.f(f).TRAVELS).data,h=null==l?void 0:l.find(e=>e.selected),j=null==h?void 0:h.travelId,S=null==h?void 0:h.userCode,N=i._(r.useQueries({queries:[{queryKey:[e.f(f).DRIVER_DETAIL,S],queryFn:()=>e.f(x).getDriverByCode(S),enabled:!!h},{queryKey:[e.f(f).TRAVEL_PASSENGERS,j],queryFn:()=>e.f(p).getTravelPassengers(j),enabled:!!j}]}),2),g=N[0].data,E=N[1].data,T=r.useQueryClient(),Q=v.useQueryStore(e.f(f).TRAVELS),R=Q.data,V=Q.setQueryStore,q=r.useMutation({mutationFn:a=>e.f(m).acceptOffer(a),onMutate:()=>(V(e=>e.map(e=>e.travelId===j?n._(t._({},e),{freeSeats:e.freeSeats-1}):e)),s(),{previousTravels:R}),onSuccess:()=>{T.invalidateQueries({queryKey:[e.f(f).TRAVELS]}),e.f(d).success("Te uniste a la oferta de viaje");},onError:(a,s,l)=>{var t=a.message;V(()=>null==l?void 0:l.previousTravels),e.f(d).error(t);}}).mutate,A=(null==g?void 0:g.seats)-(null==h?void 0:h.freeSeats),C=A-(null==E?void 0:E.length);return c.jsxs("article",{children:[c.jsxs("header",{className:"flex flex-col py-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("h2",{className:"font-bold text-3xl ",children:b.capitalize(null==h?void 0:h.name.split(" ")[0])+" ðŸš˜"}),c.jsxs("span",{className:"text-2xl font-bold ",children:[y.formatCurrency(null==h?void 0:h.fee)," "]})]}),c.jsx("span",{className:"badge ".concat((null==h?void 0:h.direction)?"badge-primary":"badge-secondary"),children:(null==h?void 0:h.direction)?"Ida":"Vuelta"})]}),c.jsxs("main",{children:[c.jsxs("section",{children:[c.jsx("p",{className:"text-xl text-accent font-bold text-pretty",children:"".concat((null==h?void 0:h.direction)?"Llega a la universidad ":"Sale de la universidad ").concat(e.f(o)(null==h?void 0:h.travelDate).calendar())}),c.jsx(u.SeatsStatus,{maxSeats:null==h?void 0:h.seats,reservedSeats:(null==g?void 0:g.seats)-(null==h?void 0:h.freeSeats)})]}),c.jsx("section",{className:"py-1",children:c.jsx("p",{className:"text-lg text-balance",children:null==h?void 0:h.customPoint})}),c.jsxs("section",{children:[(null==E?void 0:E.length)>0&&c.jsxs("p",{className:"text-base-content text-opacity-70",children:["Nos acompaÃ±a".concat(A>1?"n":"")," "]}),c.jsx("ul",{className:"flex gap-2",children:null==E?void 0:E.map((e,a)=>c.jsx("li",{className:"font-bold",children:b.capitalize(e.name.split(" ")[0])},a))}),C>0&&c.jsx("p",{className:"text-base-content text-opacity-70",children:"y ".concat(C," persona").concat(C>1?"s":""," mÃ¡s")}),(null==h?void 0:h.freeSeats)>0&&c.jsx("p",{className:"text-base-content text-opacity-70",children:"Queda espacio para ".concat(null==h?void 0:h.freeSeats," persona").concat((null==h?void 0:h.freeSeats)>1?"s":""," ")})]}),c.jsx("section",{className:"flex justify-end",children:c.jsx("button",{className:"btn btn-primary animate-pulse",disabled:(null==h?void 0:h.freeSeats)===0,onClick:()=>{q(j);},children:"Vamos!"})})]})]});}},"fea3b793":function e(e,t,a,r){e._m(t),e.o(t,"getNextIntervalTime",()=>i),e.o(t,"getDefaultDirectionValue",()=>l),e.o(t,"optimisticUpdate",()=>v),e.o(t,"getDriverTravelData",()=>s),e.o(t,"getPassengerTravelData",()=>m),a("2003e4a5"),a("a7612d50"),a("4ba47fd0"),a("38afb942"),a("74809578");var o=a("e0262023");a("6982241b"),a("61128824");var n=e.i(a("3b359b6b")),i=()=>{var t=e.f(n)();return(30>t.minute()?t.clone().startOf("hour").add(30,"minutes"):t.clone().startOf("hour").add(1,"hour")).format("HH:mm");},l=()=>e.f(n)(e.f(n)().format("HH:mm"),"HH:mm").isBefore(e.f(n)("12:00","HH:mm"))?o.TravelDirection.INBOUND:o.TravelDirection.OUTBOUND,v=(e,t)=>a=>(t(e=>e?[a,...e]:[a]),{previousTravels:e}),s=(t,a)=>{var r,o=!!parseInt(t.get("direction")),i=t.get("bookedSeats")?parseInt(t.get("bookedSeats")):0,l=(null==a?void 0:a.seats)-i,v=t.get("fee")?parseFloat(t.get("fee")):null==a?void 0:a.fee,s=null!==(r=t.get("travelDay"))&&void 0!==r?r:e.f(n)().format("YYYY-MM-DD"),m=t.get("travelTime"),u="".concat(s,"T").concat(m,":00");return{travelId:Math.random().toString(36),fee:v,travelDate:u,direction:o,travelType:"offer",name:null==a?void 0:a.name,seats:null==a?void 0:a.seats,freeSeats:l,preview:!0};},m=(t,a)=>{var r,o,i,l,v=!!parseInt(t.get("direction")),s=null!==(r=t.get("travelDay"))&&void 0!==r?r:e.f(n)().format("YYYY-MM-DD"),m=t.get("travelTime"),u=(null!==(o=t.get("forMe"))&&void 0!==o?o:"true")==="true",d=parseInt(null!==(i=t.get("numPassengers"))&&void 0!==i?i:"1"),f=null!==(l=t.get("customPoint"))&&void 0!==l?l:a.pickUpPoint,g="".concat(s,"T").concat(m,":00");return{travelId:Math.random().toString(36),travelDate:g,direction:v,travelType:"request",name:null==a?void 0:a.name,numPassengers:d,preview:!0,customPoint:f,forSelf:u,seats:d};};},});
//# sourceMappingURL=home_index_cfe6.6b8a7177.js.map