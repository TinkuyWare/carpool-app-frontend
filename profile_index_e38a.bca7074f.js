(function(_){for(var r in _){_[r].__farm_resource_pot__='profile_index_e38a.js';(globalThis || window || global)['0f6266587c3c880ed98055938bafcf5c'].__farm_module_system__.register(r,_[r])}})({"4e824a7d":function e(e,s,r,a){e._m(s),e.o(s,"default",()=>u);var n=r("957d803e");r("74809578");var o=r("036dd75c"),t=e.i(r("38869417")),d=r("dcd4b961"),i=r("5ef950a6"),l=e.i(r("7299281c")),c=r("da0b8b76");function u(){var s=c.useRef(null),r=n._(c.useState(!1),2),a=r[0],u=r[1],x=d.useMutation({mutationFn:e.f(l).changePassword,onSuccess:()=>{var r;e.f(t).success("Contraseña cambiada correctamente"),null===(r=s.current)||void 0===r||r.reset();},onError:s=>{e.f(t).error(s.message);}}),m=x.mutate,f=x.isPending,w=()=>{u(!a);};return o.jsxs("form",{ref:s,className:"flex flex-col gap-2",onSubmit:s=>{s.preventDefault();var r,a,n=new FormData(s.currentTarget);if(n.get("newPassword")!==n.get("confirmPassword")){e.f(t).error("Las contraseñas no coinciden");return;}m({password:null===(r=n.get("currentPassword"))||void 0===r?void 0:r.toString(),newPassword:null===(a=n.get("newPassword"))||void 0===a?void 0:a.toString()});},children:[o.jsxs("div",{className:"flex flex-col",children:[o.jsx("label",{htmlFor:"currentPassword",children:"Contraseña actual"}),o.jsx("input",{className:"input input-bordered",id:"currentPassword",name:"currentPassword",type:"password",required:!0})]}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("label",{htmlFor:"newPassword",children:"Nueva Contraseña"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("input",{className:"input input-bordered flex-grow",id:"newPassword",name:"newPassword",type:a?"text":"password",required:!0}),o.jsx("button",{type:"button",onClick:w,children:a?o.jsx(i.IconEye,{}):o.jsx(i.IconEyeClosed,{})})]})]}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("label",{htmlFor:"confirmPassword",children:"Confirmar Contraseña"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("input",{className:"input input-bordered flex-grow ",id:"confirmPassword",name:"confirmPassword",type:a?"text":"password",required:!0}),o.jsx("button",{type:"button",onClick:w,children:a?o.jsx(i.IconEye,{}):o.jsx(i.IconEyeClosed,{})})]})]}),o.jsx("div",{className:"flex justify-center",children:o.jsx("button",{type:"submit",disabled:f,className:"btn btn-primary",children:f?o.jsx("span",{className:"loading  loading-spipner"}):"Cambiar contraseña"})})]});}},"5894953b":function e(e,l,a,t){e._m(l),e.o(l,"default",()=>s),a("1135e585");var d=a("036dd75c"),i=a("ebc3afb6");function s(e){var l,a,t,s,r,n,u,o=e.updateMode,c=i.useSelector(e=>e.user).user;return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"col-span-1 flex flex-col",children:[d.jsx("label",{htmlFor:"plate",children:"Placa"}),d.jsx("input",{className:"input input-bordered",name:"plate",id:"plate",type:"text",defaultValue:null!==(a=c.plate)&&void 0!==a?a:"",minLength:7,maxLength:7,pattern:"[A-Z0-9]{3}-[0-9]{3}",placeholder:"ABC-123",disabled:!o,required:!0})]}),d.jsxs("div",{className:"col-span-1 flex flex-col",children:[d.jsx("label",{htmlFor:"vehicleDescription",children:"Descripción de vehículo"}),d.jsx("input",{className:"input input-bordered",type:"text",name:"vehicleDescription",id:"vehicleDescription",defaultValue:null!==(t=c.vehicleDescription)&&void 0!==t?t:"",disabled:!o,placeholder:"Ej. Toyota rojo",maxLength:100,required:!0})]}),d.jsxs("div",{className:"col-span-1 flex flex-col",children:[d.jsx("label",{htmlFor:"fee",children:"Tarifa"}),d.jsx("input",{className:"input input-bordered",type:"number",name:"fee",id:"fee",defaultValue:null!==(s=null===(l=c.fee)||void 0===l?void 0:l.toFixed(2))&&void 0!==s?s:"5.00",disabled:!o,min:0,step:.5,max:99.99,required:!0})]}),d.jsxs("div",{className:"col-span-1 flex flex-col",children:[d.jsx("label",{htmlFor:"seats",children:"Asientos disponibles"}),d.jsx("input",{className:"input input-bordered",type:"number",name:"seats",id:"seats",defaultValue:null!==(r=c.seats)&&void 0!==r?r:"4",disabled:!o,min:1,max:10,required:!0})]}),d.jsxs("div",{className:"col-span-2 flex flex-col",children:[d.jsx("label",{htmlFor:"routeIn",children:"Ruta de ida"}),d.jsx("textarea",{className:"textarea textarea-bordered",name:"routeIn",id:"routeIn",defaultValue:null!==(n=c.routeIn)&&void 0!==n?n:"",disabled:!o,placeholder:"Describe tu ruta de ida",maxLength:100,required:!0})]}),d.jsxs("div",{className:"col-span-2 flex flex-col",children:[d.jsx("label",{htmlFor:"routeOut",children:"Ruta de vuelta"}),d.jsx("textarea",{className:"textarea textarea-bordered",name:"routeOut",id:"routeOut",defaultValue:null!==(u=c.routeOut)&&void 0!==u?u:"",disabled:!o,placeholder:"Describe tu ruta de vuelta",maxLength:100,required:!0})]})]});}},"7f507c53":function e(e,a,r,t){e._m(a),e.o(a,"default",()=>c);var d=r("036dd75c"),i=r("ebc3afb6");function c(e){var a=e.updateMode,r=i.useSelector(e=>e.user).user;return d.jsx(d.Fragment,{children:d.jsxs("div",{className:"col-span-2 flex flex-col",children:[d.jsx("label",{htmlFor:"pickUpPoint",children:"Referencia de Paradero"}),d.jsx("textarea",{className:"textarea textarea-bordered",id:"pickUpPoint",name:"pickUpPoint",maxLength:100,defaultValue:r.pickUpPoint,disabled:!a,required:!0})]})});}},"8054e03e":function e(e,a,s,t){e._m(a),e.o(a,"default",()=>z);var l=s("95dab18f"),n=s("c919fece"),r=s("957d803e");s("74809578"),s("38afb942"),s("4ba47fd0");var i=s("036dd75c"),c=e.i(s("fae7f52f")),d=s("ebc3afb6"),o=e.i(s("2bc5db2e")),u=s("dcd4b961"),p=s("65738078"),f=s("da0b8b76"),x=e.i(s("5894953b")),m=e.i(s("7f507c53")),b=e.i(s("38869417")),h=s("c0e2ffb1"),j=e.i(s("6982241b")),v=e.i(s("61128824")),N=e.i(s("80b65418")),g=e.i(s("4e824a7d")),y=e.i(s("cfc8ee4c"));function z(){var a,s=d.useSelector(e=>e.user),t=s.type,z=s.user,D=s.syncUser,I=r._(f.useState(!1),2),S=I[0],F=I[1],P=r._(f.useState("profile"),2),_=P[0],q=P[1],E=f.useRef(null),M=u.useQuery({queryKey:[e.f(c).ZONES],queryFn:e.f(o).getZones}).data,U=u.useMutation({mutationFn:a=>"driver"===t?e.f(j).updateDriver(a):e.f(v).updatePassenger(a),onMutate:e=>(F(!1),D(l._({},z,e)),{previousData:z}),onError:(a,s,t)=>{var l,n=a.message;(null==t?void 0:t.previousData)&&D(t.previousData),null===(l=E.current)||void 0===l||l.reset(),e.f(b).error(n);},onSuccess:()=>{e.f(b).success("Perfil actualizado");}}).mutate;return i.jsxs("article",{className:"px-4 flex flex-col gap-4 mt-2",children:[i.jsxs("section",{children:[i.jsx(e.f(N),{setPage:q}),i.jsxs("header",{className:"text-center",children:[i.jsxs("p",{className:"font-bold text-xl",children:[" ",p.capitalize(z.name)]}),i.jsx("p",{className:"font-bold text-xl",children:p.capitalize(z.lastname)}),i.jsx("p",{className:"text-base-content text-opacity-70",children:"driver"===t?"Conductor(a)":"Pasajero/a"}),i.jsx("p",{className:"text-base-content text-opacity-70",children:z.email}),i.jsx("p",{className:"text-base-content text-opacity-70",children:z.code})]})]}),i.jsxs("main",{children:["role"===_&&i.jsx(e.f(y),{}),"password"===_&&i.jsx(e.f(g),{}),"profile"===_&&i.jsxs("form",{ref:E,className:"grid grid-cols-2 gap-y-3 gap-x-1",onSubmit:S?e=>{e.preventDefault();var a,s=new FormData(e.currentTarget),t={};s.forEach((e,a)=>{t[a]=e.toString();});var r=n._(l._({},t),{pickUpPoint:t.pickUpPoint,plate:null===(a=t.plate)||void 0===a?void 0:a.toUpperCase(),fee:parseFloat(t.fee),seats:parseInt(t.seats),zoneId:parseInt(t.zoneId)});h.equalObjects(r,z)?F(!1):U(r);}:e=>{e.preventDefault(),F(!0);},children:[i.jsxs("div",{className:"col-span-1 flex flex-col",children:[i.jsx("label",{htmlFor:"phone",children:"Celular"}),i.jsx("input",{className:"input",type:"tel",name:"phone",id:"phone",minLength:9,maxLength:9,defaultValue:z.phone,disabled:!S,required:!0})]}),i.jsxs("div",{className:"col-span-1 flex flex-col",children:[i.jsx("label",{htmlFor:"zone",children:"Zona"}),i.jsx("select",{className:"select",name:"zoneId",id:"zoneId",defaultValue:null==M?void 0:null===(a=M.find(e=>e.id===z.zoneId))||void 0===a?void 0:a.id,disabled:!S,required:!0,children:null==M?void 0:M.map(e=>i.jsx("option",{value:e.id,children:e.name},e.id))})]}),"driver"===t?i.jsx(e.f(x),{updateMode:S}):i.jsx(e.f(m),{updateMode:S}),i.jsx("div",{className:"col-span-2 flex justify-center gap-2",children:i.jsx("button",{className:"btn btn-primary",children:S?"Guardar":"Editar"})})]})]})]});}},"80b65418":function e(e,n,r,i){e._m(n),e.o(n,"default",()=>j);var d=r("95dab18f"),o=r("c919fece"),s=r("957d803e");r("38afb942");var l=r("036dd75c"),a=e.i(r("f7176859")),t=r("ebc3afb6"),c=e.i(r("6982241b")),u=e.i(r("61128824")),b=r("5ef950a6"),f=r("dcd4b961"),h=r("da0b8b76"),v=r("0c36c8b6"),x=r("28724cd6");function j(n){var r=n.setPage,i=v.useNavigate(),j=t.useSelector(e=>e.user),m=j.type,p=j.setType,C=j.user,g=j.syncUser,k=f.useMutation({mutationFn:()=>"driver"===m?e.f(u).getPassengerByCode(null==C?void 0:C.code):e.f(c).getDriverByCode(null==C?void 0:C.code),onSuccess:e=>{"object"==typeof e&&("driver"===m?g(o._(d._({},e),{both:!0})):g(o._(d._({},e),{fee:parseFloat(e.fee),both:!0})));},onSettled:()=>{p("driver"===m?"passenger":"driver");}}).mutate,y=s._(h.useState(!1),2),_=y[0],w=y[1],N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&r(e),w(!1);};return l.jsx("div",{children:l.jsxs("div",{className:"dropdown",children:[l.jsx("div",{tabIndex:0,role:"button",className:"btn btn-ghost btn-circle btn-xs",onClick:()=>w(!_),children:l.jsx(b.IconMenu2,{})}),_&&l.jsxs("ul",{tabIndex:0,className:"menu menu-sm dropdown-content bg-base-100 rounded-box z-[1] mt-3 w-52 p-2 shadow",children:[l.jsx("li",{children:l.jsx("a",{onClick:()=>N("profile"),children:"Editar perfil"})}),l.jsx("li",{children:l.jsx("a",{onClick:()=>N("password"),children:"Cambiar contraseña"})}),l.jsx("li",{children:l.jsx("a",{onClick:()=>{(null==C?void 0:C.both)?k():r("role"),w(!1);},children:"Cambiar rol"})}),l.jsx("li",{children:l.jsx("a",{onClick:()=>{x.removeCookie("tkn"),i(e.f(a).LOGIN),p(""),g(null);},children:"Cerrar sesión"})})]})]})});}},"c0e2ffb1":function e(e,c,t,n){function b(e,c){var t=Object.keys(e),n=Object.keys(c);return t.filter(e=>n.includes(e)).every(t=>e[t]===c[t]);}e._m(c),e.o(c,"equalObjects",()=>b),t("e418ffc9"),t("07bb7302");},"cfc8ee4c":function e(e,r,a,o){e._m(r),e.o(r,"default",()=>v);var s=a("95dab18f"),t=a("c919fece");a("38afb942"),a("74809578");var n=a("036dd75c"),c=a("ebc3afb6"),d=e.i(a("5894953b")),i=e.i(a("7f507c53")),l=a("dcd4b961"),u=e.i(a("6982241b")),f=e.i(a("61128824")),p=e.i(a("38869417")),g=a("0c36c8b6");function v(){var r=c.useSelector(e=>e.user),a=r.syncUser,o=r.type,v=r.user,b=r.setType,m=g.useNavigate(),h=l.useMutation({mutationFn:r=>"passenger"===o?e.f(u).createDriver(s._({code:null==v?void 0:v.code},r)):e.f(f).createPassenger(s._({code:null==v?void 0:v.code},r)),onError:r=>{var a=r.message;e.f(p).error(a);},onSuccess:()=>{"driver"===o&&e.f(f).getPassengerByCode(null==v?void 0:v.code).then(e=>{a(t._(s._({},e),{both:!0})),b("passenger");}).catch(()=>{e.f(p).error("Error al obtener el perfil de pasajero");}),"passenger"===o&&e.f(u).getDriverByCode(null==v?void 0:v.code).then(e=>{a(t._(s._({},e),{fee:parseFloat(e.fee),both:!0})),b("driver");}).catch(()=>{e.f(p).error("Error al obtener el perfil de conductor");}),m(0);}}),j=h.mutate,y=h.isPending;return n.jsxs("form",{className:"grid grid-cols-2 gap-2",onSubmit:e=>{e.preventDefault();var r=new FormData(e.currentTarget),a={};r.forEach((e,r)=>{a[r]=e.toString();}),j(a);},children:["driver"===o&&n.jsx(e.f(i),{updateMode:!0}),"passenger"===o&&n.jsx(e.f(d),{updateMode:!0}),n.jsx("div",{className:"col-span-2 flex justify-center",children:n.jsx("button",{className:"btn btn-primary",type:"submit",children:y?n.jsx("span",{className:"loading loading-spinner"}):"Registrarse como ".concat("driver"===o?"pasajero":"conductor ")})})]});}},});
//# sourceMappingURL=profile_index_e38a.bca7074f.js.map